# Telegram-бот для ответов на часто задаваемые вопросы абитуриентов.


## Описание
Программа создана в рамках выпуской квалификационной работы бакалавра, для использования приемной комиссией университета. 
Главная цель данного бота - снизить загруженность работников приемной комиссии, путём автоматизации процесса ответов на частые вопросы абитуриентов.

В административной панели, с помощью веб-интерфейса можно добавлять, удалять, изменять вопросы и ответы, которые используются в боте. Также в бота был добавлен функционал отправки вопроса администратору напрямую, на случай, если задаваемого вопроса нет в базе. В админ-панели бота можно блокировать пользователей и добавлять новых администраторов.

Все описанное должно сделать процесс ответов на вопросы максимально удобным и быстрым.

## Установка и запуск
Бот работает в связке с приложением Flask. 
В случае, если вы запускаете Flask на другом сервере (не localhost) или на нестандартном порту (5000), вам необходимо заменить переменную flask_url в файле bot/config.py на адрес вашего сервера.

### Первоначальная настройка
В файле  **setenv.sh** пропишите доступы к базе данных, а так же токен вашего telegram бота.

В файлах прилагается дамп базы данных PostgreSQL, который необходимо импортировать в пустую базу.

В папку **flask/services/model** необходимо поместить модель fastText, можно использовать свою, либо скачать https://drive.google.com/file/d/1UdI8T-PpjU_Be11odUG7SZs5zu8aoVBF/view?usp=sharing

### Запуск Flask приложения 


    . ./setenv.sh
    cd flask
    python3 -m venv env
    . ./env/bin/activate
    pip install -r requirements.txt
    python app.py



### Запуск Telegram-бота


    . ./setenv.sh
    cd bot
    python3 -m venv env
    . ./env/bin/activate
    pip install -r requirements.txt
    python bot.py

После запуска всех приложений, убедитесь что бот работает введя команду **/start** 

Для добавления первого администратора бота необходимо ввести команду **/adm**.


## База данных
В боте используется база данных PostgreSQL со следующей стркутурой:

| users   | qa_faq  | qa_speak|   no_answer |
| -------:|-------:| -------:|-------------:|
| id      | id      |    id  |           id |
| chat_id | quest   |  quest |        quest |
| status  | answer  | answer |       vector |
|         | vector  | vector | questioner_id|

Помимо использовании таблицы с ответами на FAQ, в боте также добавлена таблица с разговорными вопросами ответами qa_speak. (например "Как дела?" - "Всё хорошо", "Что делаешь?" - "С тобой общаюсь" и т. д.). На данный момент в таблице сейчас около 10000 записей формата вопрос-ответ. 
